

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; documentación de nekStab - 1.0.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> nekStab
          

          
          </a>

          
            
            
              <div class="version">
                main
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing and running</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapting.html">Adapting your case</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapting.html#programming-best-practices">Programming best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="sourcecode.html">Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_log.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_log.html#changelog-on-nek5000">Changelog on Nek5000</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">nekStab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/ricardofrantz/nekStabDoc/blob/master/docs/theory.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Enlace permanente a este encabezado">¶</a></h1>
<section id="computational-approach">
<span id="intro-comput-approach"></span><h2>Computational Approach<a class="headerlink" href="#computational-approach" title="Enlace permanente a este encabezado">¶</a></h2>
<p>The spatial discretization is based on the spectral element method (SEM) <a class="reference internal" href="NekDoc/references.html#patera1984" id="id1"><span>[Patera1984]</span></a>, which is a
high-order weighted residual technique similar to the finite element method.   In the SEM, the
solution and data are represented in terms of <span class="math notranslate nohighlight">\(N\)</span> th-order tensor-product polynomials within each
of <span class="math notranslate nohighlight">\(E\)</span> deformable hexahedral (brick) elements. Typical discretizations involve
<span class="math notranslate nohighlight">\(E\)</span>=100–10,000 elements of order <span class="math notranslate nohighlight">\(N\)</span>=8–16 (corresponding to 512–4096 points per
element).  Vectorization and cache efficiency derive from the local lexicographical ordering within
each macro-element and from the fact that the action of discrete operators, which nominally have
<span class="math notranslate nohighlight">\(O(EN^6)\)</span> nonzeros, can be evaluated in only <span class="math notranslate nohighlight">\(O(EN^4)\)</span> work and <span class="math notranslate nohighlight">\(O(EN^3)\)</span> storage
through the use of tensor-product-sum factorization <a class="reference internal" href="NekDoc/references.html#orszag1980" id="id2"><span>[Orszag1980]</span></a>.   The SEM exhibits very little
numerical dispersion and dissipation, which can be important, for example, in stability
calculations, for long time integrations, and for high Reynolds number flows. We refer to
<a class="reference internal" href="NekDoc/references.html#denville2002" id="id3"><span>[Denville2002]</span></a> for more details.</p>
<p>Nek5000 solves the unsteady incompressible two-dimensional, axisymmetric, or three-dimensional
Stokes or Navier-Stokes equations with forced or natural convection heat transfer in both
stationary (fixed) or time-dependent geometry. It also solves the compressible Navier-Stokes in the
Low Mach regime, the magnetohydrodynamic equation (MHD).  The solution variables are the fluid
velocity <span class="math notranslate nohighlight">\(\mathbf u=(u_{x},u_{y},u_{z})\)</span>, the pressure <span class="math notranslate nohighlight">\(p\)</span>, the temperature <span class="math notranslate nohighlight">\(T\)</span>.
All of the above field variables are functions of space <span class="math notranslate nohighlight">\({\bf x}=(x,y,z)\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>
in domains <span class="math notranslate nohighlight">\(\Omega_f\)</span> and/or <span class="math notranslate nohighlight">\(\Omega_s\)</span> defined in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-walls</span></code>.
Additionally Nek5000 can handle conjugate heat transfer problems.</p>
<figure class="align-center" id="id4">
<span id="fig-walls"></span><img alt="domains" src="figs/walls.png" />
<figcaption>
<p><span class="caption-text">Computational domain showing respective fluid and solid subdomains, <span class="math notranslate nohighlight">\(\Omega_f\)</span> and
<span class="math notranslate nohighlight">\(\Omega_s\)</span>.  The shared boundaries are denoted <span class="math notranslate nohighlight">\(\partial\Omega_f=\partial\Omega_s\)</span>
and the solid boundary which is not shared by fluid is <span class="math notranslate nohighlight">\(\overline{\partial\Omega_s}\)</span>,
while the fluid boundary not shared by solid <span class="math notranslate nohighlight">\(\overline{\partial\Omega_f}\)</span>.</span><a class="headerlink" href="#id4" title="Enlace permanente a esta imagen">¶</a></p>
</figcaption>
</figure>
</section>
<section id="incompressible-navier-stokes-equations">
<span id="intro-ns"></span><h2>Incompressible Navier-Stokes Equations<a class="headerlink" href="#incompressible-navier-stokes-equations" title="Enlace permanente a este encabezado">¶</a></h2>
<p>The governing equations of flow motion in dimensional form are</p>
<div class="math notranslate nohighlight" id="equation-ns-momentum">
<span class="eqno">(1)<a class="headerlink" href="#equation-ns-momentum" title="Enlace permanente a esta ecuación">¶</a></span>\[\rho\left(\frac{\partial\mathbf u}{\partial t} +\mathbf u \cdot \nabla \mathbf u\right) = - \nabla p + \nabla \cdot \boldsymbol\tau + \rho {\bf f} \,\, , \text{in } \Omega_f , \quad \text{  (Momentum)  }\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol\tau=\mu[\nabla \mathbf u+\nabla \mathbf u^{T}]\)</span> and <span class="math notranslate nohighlight">\(\mathbf f\)</span> is a user defined acceleration.</p>
<div class="math notranslate nohighlight" id="equation-ns-cont">
<span class="eqno">(2)<a class="headerlink" href="#equation-ns-cont" title="Enlace permanente a esta ecuación">¶</a></span>\[\nabla \cdot \mathbf u =0 \,\, , \text{in } \Omega_f, \quad \text{  (Continuity)  }\]</div>
<p>If the fluid viscosity is constant in the entire domain the viscous stress tensor can be contracted
<span class="math notranslate nohighlight">\(\nabla\cdot\boldsymbol\tau=\mu\Delta \mathbf u\)</span>, therefore one may solve the Navier–Stokes equations
in either the stress formulation, or no stress</p>
<ul class="simple">
<li><p>Variable viscosity requires the full stress tensor <span class="math notranslate nohighlight">\(\nabla \cdot \boldsymbol\tau=\nabla \cdot
\mu[\nabla \mathbf u+\nabla \mathbf u^{T}]\)</span>, and we shall refer to this as the stress formulation</p></li>
<li><p>Constant viscosity leads to a simpler stress tensor <span class="math notranslate nohighlight">\(\nabla \cdot \boldsymbol\tau=\mu\Delta \mathbf u\)</span>,
which we refer to as the “no stress” formulation</p></li>
</ul>
</section>
<section id="non-dimensional-navier-stokes">
<span id="intro-ns-nondim"></span><h2>Non-Dimensional Navier-Stokes<a class="headerlink" href="#non-dimensional-navier-stokes" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Let us introduce the following non-dimensional variables <span class="math notranslate nohighlight">\(\mathbf x^*\ = \frac{\mathbf x}{L}\)</span>,
<span class="math notranslate nohighlight">\(\mathbf u^*\ = \frac{u}{U}\)</span>, <span class="math notranslate nohighlight">\(t^*\ = \frac{tU}{L}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf f^* =\frac{\mathbf f L}{U^2}\)</span>.  For the pressure scale we have
two options:</p>
<ul class="simple">
<li><p>Convective effects are dominant i.e. high velocity flows <span class="math notranslate nohighlight">\(p^* = \frac{p}{\rho U^2}\)</span></p></li>
<li><p>Viscous effects are dominant i.e. creeping flows (Stokes flow) <span class="math notranslate nohighlight">\(p^* = \frac{p L}{\mu U}\)</span></p></li>
</ul>
<p>For highly convective flows we choose the first scaling of the pressure and obtain the
non-dimensional Navier-Stokes:</p>
<div class="math notranslate nohighlight" id="equation-ns-nondim">
<span class="eqno">(3)<a class="headerlink" href="#equation-ns-nondim" title="Enlace permanente a esta ecuación">¶</a></span>\[\frac{\partial \mathbf{u^*}}{\partial t^*} + \mathbf{u^*} \cdot \nabla \mathbf{u^*}\ = -\nabla p^* + \frac{1}{Re} \nabla\cdot \boldsymbol\tau^* + \mathbf f^*.\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol\tau^*=[\nabla \mathbf u^*+\nabla \mathbf u^{*T}]\)</span> and <span class="math notranslate nohighlight">\(\mathbf f^*\)</span> is the dimensionless user defined forcing function, e.g. gravity.</p>
<p>The non-dimensional number here is the Reynolds number <span class="math notranslate nohighlight">\(Re=\frac{\rho U L}{\mu}\)</span>.</p>
</section>
<section id="non-dimensional-energy-passive-scalar-equation">
<h2>Non-Dimensional Energy / Passive Scalar Equation<a class="headerlink" href="#non-dimensional-energy-passive-scalar-equation" title="Enlace permanente a este encabezado">¶</a></h2>
<p>A similar non-dimensionalization as for the flow equations using the non-dimensional variables
<span class="math notranslate nohighlight">\(\mathbf x^*\ = \frac{\mathbf x}{L}\)</span>,  <span class="math notranslate nohighlight">\(\mathbf u^*\ = \frac{u}{U}\)</span>, <span class="math notranslate nohighlight">\(t^*\ =
\frac{t}{L/U}\)</span>, <span class="math notranslate nohighlight">\(T=\frac{T^*-T_0}{\delta T}\)</span> leads to</p>
<div class="math notranslate nohighlight" id="equation-energy-nondim">
<span class="eqno">(4)<a class="headerlink" href="#equation-energy-nondim" title="Enlace permanente a esta ecuación">¶</a></span>\[\frac{\partial T^*}{\partial t^*} + \mathbf u^* \cdot \nabla T^* =
  \frac{1}{Pe} \nabla \cdot \nabla T^* + q_{vol}\,\, ,\text{in } \Omega_f\cup \Omega_s  \text{  (Energy)  }\]</div>
<p>where <span class="math notranslate nohighlight">\(Pe=LU/\alpha\)</span>, with <span class="math notranslate nohighlight">\(\alpha=k/\rho c_p\)</span>.</p>
</section>
<section id="passive-scalars">
<span id="intro-pass-scal"></span><h2>Passive Scalars<a class="headerlink" href="#passive-scalars" title="Enlace permanente a este encabezado">¶</a></h2>
<p>We can additionally solve a convection-diffusion equation for each passive scalar <span class="math notranslate nohighlight">\(\phi_i\)</span>,
<span class="math notranslate nohighlight">\(i = 1,2,\ldots\)</span> in <span class="math notranslate nohighlight">\(\Omega_f \cup \Omega_s\)</span></p>
<div class="math notranslate nohighlight" id="equation-pass-scal">
<span class="eqno">(5)<a class="headerlink" href="#equation-pass-scal" title="Enlace permanente a esta ecuación">¶</a></span>\[(\rho c_{p})_i \left( \frac{\partial \phi_{i}}{\partial t} + \mathbf u \cdot \nabla \phi_{i} \right) =
\nabla \cdot (k_i \nabla \phi_{i}) + (q_{vol})_i.\]</div>
<p>The terminology and restrictions of the temperature equations are retained for the passive scalars,
so that it is the responsibility of the user to convert the notation of the passive scalar
parameters to their thermal analogues.  For example, in the context of mass transfer, the user
should recognize that the values specified for temperature and heat flux will represent
concentration and mass flux, respectively.  Any combination of these equation characteristics is
permissible with the following restrictions. First, the equation must be set to unsteady if it is
time-dependent or if there is any type of advection. For these cases, the steady-state (if it
exists) is found as stable evolution of the initial-value-problem. Secondly, the stress formulation
must be selected if the geometry is time-dependent. In addition, stress formulation must be
employed if there are traction boundary conditions applied on any fluid boundary, or if any mixed
velocity/traction boundaries, such as symmetry and outflow/n, are not aligned with either one of
the Cartesian <span class="math notranslate nohighlight">\(x,y\)</span> or <span class="math notranslate nohighlight">\(z\)</span> axes.  Other capabilities of Nek5000 are the linearized
Navier-Stokes for flow stability, magnetohydrodynamic flows etc.</p>
</section>
<section id="linearized-equations">
<span id="intro-linear-eq"></span><span id="intro-ns-stokes"></span><h2>Linearized Equations<a class="headerlink" href="#linearized-equations" title="Enlace permanente a este encabezado">¶</a></h2>
<p>In addition to the basic evolution equations described above, Nek5000 provides support for the
evolution of small perturbations about a base state by solving the <em>linearized equations</em></p>
<div class="math notranslate nohighlight" id="equation-pertu">
<span class="eqno">(6)<a class="headerlink" href="#equation-pertu" title="Enlace permanente a esta ecuación">¶</a></span>\[\begin{split}\rho\left(\frac{\partial \mathbf u_i'}{\partial t} + \mathbf u \cdot \nabla {\mathbf u_i}^{'} + \mathbf u_i' \cdot \nabla \mathbf u \right) &amp;=
- \nabla p_i' + \mu \nabla^2 \mathbf u_i'\\
\nabla \cdot \mathbf u_i' &amp;= 0 \nonumber\end{split}\]</div>
<p>for multiple perturbation fields <span class="math notranslate nohighlight">\(i=1,2,\dots\)</span> subject to different initial
conditions and (typically) homogeneous boundary conditions.</p>
<p>These solutions can be evolved concurrently with the base fields <span class="math notranslate nohighlight">\((\mathbf u,p,T)\)</span>.  There is
also support for computing perturbation solutions to the Boussinesq equations for natural
convection.  Calculations such as these can be used to estimate Lyapunov exponents of chaotic
flows, etc.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, Ricardo Frantz

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: main
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Languages</dt>
        
          
          <dd><a href="/nekStabDoc/en/main/">en</a></dd>
          
        
           <strong> 
          <dd><a href="/nekStabDoc/es/main/">es</a></dd>
           </strong> 
        
      </dl>
      
      
      <dl>
        <dt>Versions</dt>
        
           <strong> 
          <dd><a href="/nekStabDoc/es/main/">main</a></dd>
           </strong> 
        
      </dl>
      
      
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/nekStabDoc/es/main/nekStab-docs_es_main.pdf">pdf</a></dd>
        
          <dd><a href="/nekStabDoc/es/main/nekStab-docs_es_main.epub">epub</a></dd>
        
      </dl>
      
      
      <hr/>
      <a href="https://tech.michaelaltfield.net/2020/07/18/sphinx-rtd-github-pages-1/">Continuous Documentation</a> hosting provided by <a href="https://pages.github.com/">GitHub Pages</a>.
 
    </div>
  </div>

 

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>